---
title: "SPUTNIK"
author: "Paolo Inglese"
date: "21/10/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## SPUTNIK

Welcome to SPUTNIK Github Page!
SPUTNIK is a filter tool for Mass Spectrometry Imaging (MSI) data. It is designed
to identify and remove the mass spectral peaks that are spatially unrelated with
the sample of interest. Often MSI data contain signal generated by the analytical
technique used for the ion desorption. For instance, DESI-MSI data can contain
solvent-related signals, or, in the case of MALDI-MSI, matrix-related signal can
be part of the data.
These signals are non-informative about the molecular content of the analyzed
sample, and can interfere with the statistical analysis of the data. Furthermore,
the presence of these signals makes the dimensionality of the data uselessly big.
SPUTNIK uses three classes of filters to identify and remove these types of
signals.
The first family of filters, called *general similarity filters*, uses the expected
location of the sample (ROI) to determine if a signal is informative or not.
Simple similarity measures between the ROI, or a continuous reference signal
representing the area occupied by the sample, and the images generated by the
peak signals are used to determine whether a peak is informative.
The continuous reference and ROI images can be calculated from the MSI data or imported.
There are four methods to calculate the continuous reference:

* "sum": sum of all the peak intensities
* "mean": non-zero mean of all the peak intensities
* "median": non-zero median of all the peak intensities
* "pca": first principal component scores are assigned to the pixels intensities

There are also four methods to calculate the ROI:

* "otsu": the continuous reference (calculated using one of the previous methods)
is binarized using Otsu's thresholding
* "kmeans": k-means with 2 clusters is applied to the entire MSI dataset to
generate a binary ROI
* "kmeans2": k-means with N (N > 2) clusters is applied to the entire MSI dataset
to generate a segmentation of the image. Then, the clusters are merged into sample-related
and sample-unrelated.
* "supervised": the user annotates two areas of the image as sample-unrelated and
sample-related. A linear SVM, trained on those spectra, is used to assign the
labels to all the remaining pixels.

For instance, continuous reference and ROI from Rompp et al. MALDI-MSI
dataset are calculated as follows.

```{r load SPUTNIK}
library(SPUTNIK)
```

First load the example MALDI-MSI data
```{r load Rompp}
bladderMALDI <- bladderMALDIRompp2010() 
```

Then, create the msiDataset object
```{r create msiDataset}
msiX <- msiDataset(values = bladderMALDI,
                   mz = attr(bladderMALDI, 'mass'),
                   rsize = attr(bladderMALDI, 'size')[1],
                   csize = attr(bladderMALDI, 'size')[2])
```
